{
  "tasks": [
    {
      "id": "S1a-code",
      "name": "Socket activation \u2013 agent plumbing (code)",
      "type": "code",
      "phase": "S1a \u2013 Agent Socket Activation",
      "status": "completed",
      "description": "Teach world-agent to consume LISTEN_FDS sockets, emit telemetry about inherited listeners, and preserve the direct-bind fallback path.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "docs/BACKLOG.md",
        "crates/world-agent",
        "crates/world-linux",
        "crates/world-mac-lima",
        "crates/world-windows-wsl",
        "docs/WORLD.md"
      ],
      "acceptance_criteria": [
        "world-agent detects LISTEN_FDS/FD_START using systemd conventions and skips binding when sockets are provided.",
        "Inherited sockets produce structured telemetry/logs noting socket activation vs manual bind.",
        "Direct-bind behavior remains unchanged for non-systemd hosts.",
        "`cargo fmt`; `cargo clippy -p world-agent -- -D warnings`; `cargo test -p world-agent` executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set S1a-code to in_progress, log START entry, commit docs update",
        "Create branch ps-s1a-agent-code",
        "Create worktree wt/ps-s1a-agent-code from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests completed (note skips)",
        "Commit worktree changes",
        "Merge ps-s1a-agent-code into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm S1a-integ prompt reference",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [],
      "concurrent_with": [
        "S1a-test"
      ],
      "worktree": "wt/ps-s1a-agent-code",
      "integration_task": "S1a-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1a-code.md"
    },
    {
      "id": "S1a-test",
      "name": "Socket activation \u2013 agent plumbing (test)",
      "type": "test",
      "phase": "S1a \u2013 Agent Socket Activation",
      "status": "completed",
      "description": "Add unit/integration tests that simulate LISTEN_FDS activation, verify telemetry, and guard the direct-bind fallback.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "docs/BACKLOG.md",
        "crates/world-agent",
        "crates/world/tests"
      ],
      "acceptance_criteria": [
        "Tests cover LISTEN_FDS env detection plus FD numbering edge cases (single + multiple sockets).",
        "Integration tests validate the fallback path when LISTEN_FDS unset.",
        "Telemetry assertions ensure activation metadata appears in spans/logs.",
        "`cargo fmt`; `cargo test -p world-agent`; LISTEN_FDS harness executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set S1a-test to in_progress, log START entry, commit docs update",
        "Create branch ps-s1a-agent-test",
        "Create worktree wt/ps-s1a-agent-test from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/tests completed (note skips)",
        "Commit worktree changes",
        "Merge ps-s1a-agent-test into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm S1a-integ prompt accuracy",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [],
      "concurrent_with": [
        "S1a-code"
      ],
      "worktree": "wt/ps-s1a-agent-test",
      "integration_task": "S1a-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1a-test.md"
    },
    {
      "id": "S1a-integ",
      "name": "Socket activation \u2013 agent plumbing (integration)",
      "type": "integration",
      "phase": "S1a \u2013 Agent Socket Activation",
      "status": "completed",
      "description": "Merge the S1a code/test branches, re-run fmt/lint/tests, and update docs/logs before unlocking shell work.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/world-agent"
      ],
      "acceptance_criteria": [
        "wt/ps-s1a-agent-integ merges ps-s1a-agent-code/test with no conflicts and syncs to feat/p0-platform-stability.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; `cargo test -p world-agent` executed/logged.",
        "Docs/tasks/session log updated; kickoff prompts for S1b-code/S1b-test referenced."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Confirm S1a-code/test completed",
        "Set S1a-integ to in_progress, log START entry, commit docs update",
        "Create branch ps-s1a-agent-integ",
        "Create worktree wt/ps-s1a-agent-integ from that branch"
      ],
      "end_checklist": [
        "Merge code/test branches, resolve conflicts",
        "Run required fmt/lint/tests",
        "Fast-forward merge into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Publish/confirm S1b prompts"
      ],
      "depends_on": [
        "S1a-code",
        "S1a-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-s1a-agent-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1a-integ.md"
    },
    {
      "id": "S1b-code",
      "name": "Socket activation \u2013 shell readiness (code)",
      "type": "code",
      "phase": "S1b \u2013 Shell Readiness & Telemetry",
      "status": "completed",
      "description": "Update shell/world orchestration (ensure_world_agent_ready, world_enable, shim status) to tolerate pre-bound sockets and emit socket-activation telemetry.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/shell/src/world/ensure_world_agent_ready.rs",
        "crates/shell/src/world",
        "crates/shell/src/builtins",
        "crates/common/src/log_schema.rs"
      ],
      "acceptance_criteria": [
        "Shell readiness checks detect when `/run/substrate.sock` already exists and avoid double-binding while still surfacing status.",
        "`substrate world enable`, `substrate world doctor --json`, and `substrate --shim-status` emit clear messaging for socket-activated installs.",
        "Trace/telemetry identifies socket activation vs manual mode for shell-originated commands.",
        "`cargo fmt`; `cargo clippy -p substrate-shell -- -D warnings`; targeted tests (`cargo test -p substrate-shell world_enable`) executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set S1b-code to in_progress, log START entry, commit docs update",
        "Create branch ps-s1b-shell-code",
        "Create worktree wt/ps-s1b-shell-code from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests completed",
        "Commit worktree changes",
        "Merge ps-s1b-shell-code into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm S1b-integ prompt",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "S1a-integ"
      ],
      "concurrent_with": [
        "S1b-test"
      ],
      "worktree": "wt/ps-s1b-shell-code",
      "integration_task": "S1b-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1b-code.md"
    },
    {
      "id": "S1b-test",
      "name": "Socket activation \u2013 shell readiness (test)",
      "type": "test",
      "phase": "S1b \u2013 Shell Readiness & Telemetry",
      "status": "completed",
      "description": "Extend shell/world doctor tests to cover socket-activated readiness, telemetry output, and shim status flows.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/shell/tests",
        "crates/world/tests",
        "docs/WORLD.md"
      ],
      "acceptance_criteria": [
        "Tests simulate pre-existing sockets and assert `ensure_world_agent_ready` succeeds only when service responds.",
        "World doctor + shim status integration suites capture socket-activation metadata in JSON/text outputs.",
        "Warnings/errors when sockets missing remain unchanged (regression coverage).",
        "`cargo fmt`; `cargo test -p substrate-shell world_enable`; `cargo test -p substrate-shell world_root` executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set S1b-test to in_progress, log START entry, commit docs update",
        "Create branch ps-s1b-shell-test",
        "Create worktree wt/ps-s1b-shell-test from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/tests completed (note skips)",
        "Commit worktree changes",
        "Merge ps-s1b-shell-test into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm S1b-integ prompt contents",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "S1a-integ"
      ],
      "concurrent_with": [
        "S1b-code"
      ],
      "worktree": "wt/ps-s1b-shell-test",
      "integration_task": "S1b-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1b-test.md"
    },
    {
      "id": "S1b-integ",
      "name": "Socket activation \u2013 shell readiness (integration)",
      "type": "integration",
      "phase": "S1b \u2013 Shell Readiness & Telemetry",
      "status": "completed",
      "description": "Merge S1b code/test worktrees, re-run fmt/lint/tests, and update docs/logs before provisioning changes begin.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/shell"
      ],
      "acceptance_criteria": [
        "wt/ps-s1b-shell-integ merges ps-s1b-shell-code/test into feat/p0-platform-stability without conflicts.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; `cargo test -p substrate-shell world_enable`; `substrate world doctor --json` smoke (or logged skip).",
        "Docs/tasks/session log updated; kickoff prompts for S1c-code/S1c-test linked."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Confirm S1b-code/test completed",
        "Set S1b-integ to in_progress, log START entry, commit docs update",
        "Create branch ps-s1b-shell-integ",
        "Create worktree wt/ps-s1b-shell-integ from that branch"
      ],
      "end_checklist": [
        "Merge code/test branches, resolve conflicts",
        "Run required fmt/lint/tests",
        "Fast-forward merge into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Publish S1c prompts"
      ],
      "depends_on": [
        "S1b-code",
        "S1b-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-s1b-shell-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1b-integ.md"
    },
    {
      "id": "S1c-code",
      "name": "Socket activation \u2013 provisioning & docs (code)",
      "type": "code",
      "phase": "S1c \u2013 Provisioning & Docs",
      "status": "completed",
      "description": "Update Linux/Lima/WSL provisioning + uninstall scripts and documentation to deploy/manage .service + .socket units.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "scripts/linux/world-provision.sh",
        "scripts/mac/lima-warm.sh",
        "scripts/windows/wsl-warm.ps1",
        "scripts/substrate/world-enable.sh",
        "docs/WORLD.md",
        "docs/INSTALLATION.md"
      ],
      "acceptance_criteria": [
        "Installers deploy matching `.service`/`.socket` units across Linux/Lima/WSL with idempotent reruns and sudo guidance.",
        "Uninstall/doctor helpers clean up both units and report their presence accurately.",
        "Docs detail socket activation behavior, troubleshooting, and manual verification commands per platform.",
        "`cargo fmt`; provisioning scripts linted (`shellcheck`/`pwsh -Command {}` as applicable) or skips logged; dry-run outputs captured."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set S1c-code to in_progress, log START entry, commit docs update",
        "Create branch ps-s1c-provision-code",
        "Create worktree wt/ps-s1c-provision-code from that branch"
      ],
      "end_checklist": [
        "Verify script/doc updates + recorded runs",
        "Commit worktree changes",
        "Merge ps-s1c-provision-code into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm S1c-integ prompt",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "S1b-integ"
      ],
      "concurrent_with": [
        "S1c-test"
      ],
      "worktree": "wt/ps-s1c-provision-code",
      "integration_task": "S1c-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1c-code.md"
    },
    {
      "id": "S1c-test",
      "name": "Socket activation \u2013 provisioning & docs (test)",
      "type": "test",
      "phase": "S1c \u2013 Provisioning & Docs",
      "status": "completed",
      "description": "Author harness coverage/dry-run verification for Linux/Lima/WSL installers/uninstallers plus world doctor scripts under socket activation.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "scripts/linux",
        "scripts/mac",
        "scripts/windows",
        "tests/installers"
      ],
      "acceptance_criteria": [
        "Provisioning harness exercises `.socket` deployment paths (dry-run allowed) and asserts expected files/units.",
        "Integration tests ensure `substrate world doctor --json` reflects installer output after provisioning/uninstall flows.",
        "Docs/tests capture platform-specific skip notes if automation unavailable.",
        "`cargo fmt`; targeted installer tests (`./tests/installers/install_smoke.sh` etc.) executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set S1c-test to in_progress, log START entry, commit docs update",
        "Create branch ps-s1c-provision-test",
        "Create worktree wt/ps-s1c-provision-test from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/tests/scripts completed (document skips)",
        "Commit worktree changes",
        "Merge ps-s1c-provision-test into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm S1c-integ prompt accuracy",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "S1b-integ"
      ],
      "concurrent_with": [
        "S1c-code"
      ],
      "worktree": "wt/ps-s1c-provision-test",
      "integration_task": "S1c-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1c-test.md"
    },
    {
      "id": "S1c-integ",
      "name": "Socket activation \u2013 provisioning & docs (integration)",
      "type": "integration",
      "phase": "S1c \u2013 Provisioning & Docs",
      "status": "completed",
      "description": "Merge S1c code/test branches, verify fmt/lint/tests, and close out the socket activation program before replay work proceeds.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "scripts/linux",
        "scripts/mac",
        "scripts/windows",
        "docs/WORLD.md"
      ],
      "acceptance_criteria": [
        "wt/ps-s1c-provision-integ merges ps-s1c-provision-code/test cleanly with feat/p0-platform-stability.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; installer harness/dry-run commands executed/logged (or justified skips).",
        "Docs/tasks/session log updated; kickoff prompts for R1a-code/R1a-test linked."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Confirm S1c-code/test completed",
        "Set S1c-integ to in_progress, log START entry, commit docs update",
        "Create branch ps-s1c-provision-integ",
        "Create worktree wt/ps-s1c-provision-integ from that branch"
      ],
      "end_checklist": [
        "Merge code/test branches, resolve conflicts",
        "Run required fmt/lint/tests/scripts",
        "Fast-forward merge into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Publish R1a prompts"
      ],
      "depends_on": [
        "S1c-code",
        "S1c-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-s1c-provision-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1c-integ.md"
    },
    {
      "id": "S1c-windows-dry-run",
      "name": "Windows WSL warm WhatIf capture",
      "type": "ops",
      "phase": "S1c \u2013 Provisioning & Docs",
      "status": "completed",
      "description": "Re-run `pwsh -File scripts/windows/wsl-warm.ps1 -WhatIf` on a Windows host with PowerShell 7 to capture the socket-activation provisioning dry-run that was skipped on Linux.",
      "references": [
        "scripts/windows/wsl-warm.ps1",
        "docs/cross-platform/wsl_world_setup.md",
        "docs/INSTALLATION.md#windows",
        "docs/project_management/next/p0-platform-stability/session_log.md"
      ],
      "acceptance_criteria": [
        "Command is executed from the repo root using PowerShell 7 (pwsh) on Windows.",
        "Output (stdout/stderr) is saved to a dated log under `artifacts/windows/` and referenced in the session log.",
        "Session log entry captures host context (Windows build, WSL availability), command exit status, notable warnings/errors, and whether socket/service units already existed.",
        "If the script indicates missing prerequisites, the log includes the remediation notes from the script along with next steps."
      ],
      "start_checklist": [
        "Clone/checkout feat/p0-platform-stability on a Windows workstation with PowerShell 7.",
        "Ensure WSL and the substrate-wsl distro (or the configured distro) are available or note their absence.",
        "Append START entry to the session log describing the host context and intent.",
        "Confirm this task is marked `in_progress` in tasks.json."
      ],
      "end_checklist": [
        "Run `pwsh -File scripts/windows/wsl-warm.ps1 -WhatIf` from repo root; capture stdout/stderr to `artifacts/windows/wsl-warm-whatif-<DATE>.log`.",
        "Record the command result, log location, and any follow-up actions in the session log END entry.",
        "Update tasks.json status to `completed`.",
        "If additional remediation is required (e.g., install VS Code Remote extensions, enable WSL optional components), capture those instructions in the END log."
      ],
      "depends_on": [
        "S1c-integ"
      ],
      "concurrent_with": [],
      "worktree": null,
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1c-windows-dry-run.md"
    },
    {
      "id": "R1a-code",
      "name": "Replay isolation fallback (code)",
      "type": "code",
      "phase": "R1a \u2013 Isolation Fallback & Diagnostics",
      "status": "completed",
      "description": "Implement nft cgroup fallback, cleanup tooling for leftover netns/rules, and tie diagnostics into replay logs/docs.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "docs/BACKLOG.md",
        "crates/world-linux",
        "crates/replay",
        "crates/trace",
        "docs/REPLAY.md",
        "docs/WORLD.md"
      ],
      "acceptance_criteria": [
        "Replay isolation attempts nft cgroup match first, falls back gracefully with telemetry when unavailable.",
        "Cleanup helpers surface residual netns/nft rules and provide CLI hooks to reset state.",
        "Docs call out fallback + cleanup flow for Linux/macOS/WSL (when applicable).",
        "`cargo fmt`; `cargo clippy -p substrate-replay -- -D warnings`; `cargo test -p substrate-replay -- --nocapture` executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set R1a-code to in_progress, log START entry, commit docs update",
        "Create branch ps-r1a-isolation-code",
        "Create worktree wt/ps-r1a-isolation-code from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests completed",
        "Commit worktree changes",
        "Merge ps-r1a-isolation-code into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm R1a-integ prompt",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "S1c-integ"
      ],
      "concurrent_with": [
        "R1a-test"
      ],
      "worktree": "wt/ps-r1a-isolation-code",
      "integration_task": "R1a-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R1a-code.md"
    },
    {
      "id": "R1a-test",
      "name": "Replay isolation fallback (test)",
      "type": "test",
      "phase": "R1a \u2013 Isolation Fallback & Diagnostics",
      "status": "completed",
      "description": "Add replay/world tests covering nft cgroup fallback paths, cleanup diagnostics, and regression coverage for existing isolation behavior.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay/tests",
        "crates/shell/tests",
        "docs/REPLAY.md"
      ],
      "acceptance_criteria": [
        "Tests exercise fallback when nft unsupported and assert telemetry/log strings.",
        "Cleanup helper tests verify detection/reporting of leftover namespaces/rules.",
        "Regression tests ensure standard path unaffected when nft available.",
        "`cargo fmt`; `cargo test -p substrate-replay -- --nocapture`; targeted shell integration suites executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set R1a-test to in_progress, log START entry, commit docs update",
        "Create branch ps-r1a-isolation-test",
        "Create worktree wt/ps-r1a-isolation-test from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/tests completed (note skips)",
        "Commit worktree changes",
        "Merge ps-r1a-isolation-test into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm R1a-integ prompt accuracy",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "S1c-integ"
      ],
      "concurrent_with": [
        "R1a-code"
      ],
      "worktree": "wt/ps-r1a-isolation-test",
      "integration_task": "R1a-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R1a-test.md"
    },
    {
      "id": "R1a-integ",
      "name": "Replay isolation fallback (integration)",
      "type": "integration",
      "phase": "R1a \u2013 Isolation Fallback & Diagnostics",
      "status": "completed",
      "description": "Merge R1a code/test branches, re-run fmt/lint/tests, and document readiness for verbose scope work.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "docs/REPLAY.md"
      ],
      "acceptance_criteria": [
        "wt/ps-r1a-isolation-integ merges ps-r1a-isolation-code/test with feat/p0-platform-stability.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; `cargo test -p substrate-replay`; cleanup helper scripts executed/logged.",
        "Docs/tasks/session log updated; kickoff prompts for R1b-code/R1b-test linked."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Confirm R1a-code/test completed",
        "Set R1a-integ to in_progress, log START entry, commit docs update",
        "Create branch ps-r1a-isolation-integ",
        "Create worktree wt/ps-r1a-isolation-integ from that branch"
      ],
      "end_checklist": [
        "Merge branches, resolve conflicts",
        "Run required fmt/lint/tests",
        "Merge into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Publish R1b prompts"
      ],
      "depends_on": [
        "R1a-code",
        "R1a-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-r1a-isolation-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R1a-integ.md"
    },
    {
      "id": "R1b-code",
      "name": "Replay verbose scopes & warnings (code)",
      "type": "code",
      "phase": "R1b \u2013 Verbose Scopes & Warning Clarity",
      "status": "completed",
      "description": "Implement the `scopes: [...]` verbose output, differentiate shell vs replay warnings, and update docs/help text.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "crates/shell/src/execution/replay.rs",
        "docs/REPLAY.md",
        "docs/TRACE.md"
      ],
      "acceptance_criteria": [
        "`substrate --replay --replay-verbose` prints scope arrays adjacent to world strategy output (text + JSON).",
        "Warnings referencing shell transport explicitly say \u201cshell world-agent path\u201d; replay warnings retain `[replay]` prefix.",
        "Docs/help text mention verbose scopes and warning semantics across POSIX + PowerShell examples.",
        "`cargo fmt`; `cargo clippy -p substrate-replay -- -D warnings`; targeted CLI smoke recorded."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set R1b-code to in_progress, log START entry, commit docs update",
        "Create branch ps-r1b-verbosity-code",
        "Create worktree wt/ps-r1b-verbosity-code from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests/manual commands complete",
        "Commit worktree changes",
        "Merge ps-r1b-verbosity-code into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm R1b-integ prompt",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "R1a-integ"
      ],
      "concurrent_with": [
        "R1b-test"
      ],
      "worktree": "wt/ps-r1b-verbosity-code",
      "integration_task": "R1b-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R1b-code.md"
    },
    {
      "id": "R1b-test",
      "name": "Replay verbose scopes & warnings (test)",
      "type": "test",
      "phase": "R1b \u2013 Verbose Scopes & Warning Clarity",
      "status": "completed",
      "description": "Add replay CLI tests verifying verbose scope output, absence when flag disabled, and warning prefixes for shell vs replay contexts.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay/tests",
        "crates/shell/tests",
        "docs/TRACE.md"
      ],
      "acceptance_criteria": [
        "Tests assert `scopes: [...]` line content under `--replay-verbose` and confirm it is omitted otherwise.",
        "Warning prefix assertions cover shell vs replay commands.",
        "JSON outputs updated fixtures to include verbose scopes when relevant.",
        "`cargo fmt`; `cargo test -p substrate-replay`; targeted shell tests executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set R1b-test to in_progress, log START entry, commit docs update",
        "Create branch ps-r1b-verbosity-test",
        "Create worktree wt/ps-r1b-verbosity-test from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/tests complete",
        "Commit worktree changes",
        "Merge ps-r1b-verbosity-test into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm R1b-integ prompt",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "R1a-integ"
      ],
      "concurrent_with": [
        "R1b-code"
      ],
      "worktree": "wt/ps-r1b-verbosity-test",
      "integration_task": "R1b-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R1b-test.md"
    },
    {
      "id": "R1b-integ",
      "name": "Replay verbose scopes & warnings (integration)",
      "type": "integration",
      "phase": "R1b \u2013 Verbose Scopes & Warning Clarity",
      "status": "completed",
      "description": "Merge R1b code/test branches, rerun fmt/lint/tests, and prepare for the replay coverage phase.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "docs/REPLAY.md",
        "docs/TRACE.md"
      ],
      "acceptance_criteria": [
        "wt/ps-r1b-verbosity-integ merges ps-r1b-verbosity-code/test cleanly.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; `cargo test -p substrate-replay`; CLI verbose smoke run logged.",
        "Docs/tasks/session log updated; kickoff prompts for R1c-code/R1c-test linked."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Confirm R1b-code/test completed",
        "Set R1b-integ to in_progress, log START entry, commit docs update",
        "Create branch ps-r1b-verbosity-integ",
        "Create worktree wt/ps-r1b-verbosity-integ from that branch"
      ],
      "end_checklist": [
        "Merge code/test branches, resolve conflicts",
        "Run required fmt/lint/tests",
        "Merge into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Publish R1c prompts"
      ],
      "depends_on": [
        "R1b-code",
        "R1b-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-r1b-verbosity-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R1b-integ.md"
    },
    {
      "id": "R1c-code",
      "name": "Replay world coverage (code)",
      "type": "code",
      "phase": "R1c \u2013 Replay World Coverage",
      "status": "completed",
      "description": "Add CLI/config plumbing to expose default world-on, `--no-world`, and env opt-out toggles to the test harness plus docs about their interactions.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/shell/src/execution/replay.rs",
        "crates/shell/src/execution/settings.rs",
        "docs/REPLAY.md",
        "docs/TRACE.md"
      ],
      "acceptance_criteria": [
        "Replay CLI exposes switches/environment override surfaces to the harness without requiring global config edits.",
        "Doc updates describe default-to-world behavior, `--no-world`, and `SUBSTRATE_REPLAY_USE_WORLD=disabled` flows.",
        "Smoke commands recorded for world-on vs no-world runs.",
        "`cargo fmt`; `cargo clippy -p substrate-shell -- -D warnings`; targeted replay tests invoked."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set R1c-code to in_progress, log START entry, commit docs update",
        "Create branch ps-r1c-coverage-code",
        "Create worktree wt/ps-r1c-coverage-code from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests/manual commands run",
        "Commit worktree changes",
        "Merge ps-r1c-coverage-code into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm R1c-integ prompt",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "R1b-integ"
      ],
      "concurrent_with": [
        "R1c-test"
      ],
      "worktree": "wt/ps-r1c-coverage-code",
      "integration_task": "R1c-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R1c-code.md"
    },
    {
      "id": "R1c-test",
      "name": "Replay world coverage (test)",
      "type": "test",
      "phase": "R1c \u2013 Replay World Coverage",
      "status": "completed",
      "description": "Expand integration suites covering default world-on, `--no-world`, and env opt-out toggles plus verbose scope output expectations.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay/tests",
        "crates/shell/tests",
        "docs/REPLAY.md"
      ],
      "acceptance_criteria": [
        "Tests run replays with worlds enabled (default), `--no-world`, and `SUBSTRATE_REPLAY_USE_WORLD=disabled`, asserting proper warnings + scope output.",
        "Fixtures updated for JSON/text outputs referencing world state toggles.",
        "Manual/smoke commands recorded when required capabilities absent (document skip).",
        "`cargo fmt`; `cargo test -p substrate-replay -- --nocapture`; targeted shell integration suites executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set R1c-test to in_progress, log START entry, commit docs update",
        "Create branch ps-r1c-coverage-test",
        "Create worktree wt/ps-r1c-coverage-test from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/tests completed",
        "Commit worktree changes",
        "Merge ps-r1c-coverage-test into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm R1c-integ prompt",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "R1b-integ"
      ],
      "concurrent_with": [
        "R1c-code"
      ],
      "worktree": "wt/ps-r1c-coverage-test",
      "integration_task": "R1c-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R1c-test.md"
    },
    {
      "id": "R1c-integ",
      "name": "Replay world coverage (integration)",
      "type": "integration",
      "phase": "R1c \u2013 Replay World Coverage",
      "status": "completed",
      "description": "Merge R1c code/test branches, re-run fmt/lint/tests, and document readiness for the health manager fixes.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "crates/shell",
        "docs/REPLAY.md"
      ],
      "acceptance_criteria": [
        "wt/ps-r1c-coverage-integ merges ps-r1c-coverage-code/test with feat/p0-platform-stability.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; `cargo test -p substrate-replay`; `cargo test -p substrate-shell replay_world` executed/logged.",
        "Docs/tasks/session log updated; kickoff prompts for H1a-code/H1a-test linked."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Confirm R1c-code/test completed",
        "Set R1c-integ to in_progress, log START entry, commit docs update",
        "Create branch ps-r1c-coverage-integ",
        "Create worktree wt/ps-r1c-coverage-integ from that branch"
      ],
      "end_checklist": [
        "Merge branches, resolve conflicts",
        "Run required fmt/lint/tests",
        "Merge into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Publish H1a prompts"
      ],
      "depends_on": [
        "R1c-code",
        "R1c-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-r1c-coverage-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R1c-integ.md"
    },
    {
      "id": "H1a-code",
      "name": "Health manager parity \u2013 aggregation logic (code)",
      "type": "code",
      "phase": "H1a \u2013 Detection & Aggregation",
      "status": "completed",
      "description": "Refine manager detection data structures and health aggregator logic so only host-present/world-missing managers trigger attention, with structured telemetry output.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "docs/BACKLOG.md",
        "crates/shell/src/builtins/health.rs",
        "crates/shell/src/manager_detection.rs",
        "docs/CONFIGURATION.md"
      ],
      "acceptance_criteria": [
        "Health aggregator exposes explicit enums for host/world status per manager and computes severity accordingly.",
        "Telemetry/log schema highlights which manager mismatched (host-only/world-only/both-missing).",
        "Existing JSON outputs continue working with new fields documented.",
        "`cargo fmt`; `cargo clippy -p substrate-shell -- -D warnings`; targeted health unit tests executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set H1a-code to in_progress, log START entry, commit docs update",
        "Create branch ps-h1a-health-code",
        "Create worktree wt/ps-h1a-health-code from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests run",
        "Commit worktree changes",
        "Merge ps-h1a-health-code into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm H1a-integ prompt",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "R1c-integ"
      ],
      "concurrent_with": [
        "H1a-test"
      ],
      "worktree": "wt/ps-h1a-health-code",
      "integration_task": "H1a-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/H1a-code.md"
    },
    {
      "id": "H1a-test",
      "name": "Health manager parity \u2013 aggregation logic (test)",
      "type": "test",
      "phase": "H1a \u2013 Detection & Aggregation",
      "status": "completed",
      "description": "Add targeted tests for the refined health aggregator covering host/world presence combinations and telemetry serialization.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/shell/tests",
        "docs/CONFIGURATION.md"
      ],
      "acceptance_criteria": [
        "Tests cover host+world missing (OK), host present/world missing (attention), world present/host missing (degrade) across manager types (direnv/asdf/conda/pyenv).",
        "JSON fixture assertions updated for new telemetry fields.",
        "`cargo fmt`; `cargo test -p substrate-shell health`; targeted integration suite executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set H1a-test to in_progress, log START entry, commit docs update",
        "Create branch ps-h1a-health-test",
        "Create worktree wt/ps-h1a-health-test from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/tests completed",
        "Commit worktree changes",
        "Merge ps-h1a-health-test into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm H1a-integ prompt",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "R1c-integ"
      ],
      "concurrent_with": [
        "H1a-code"
      ],
      "worktree": "wt/ps-h1a-health-test",
      "integration_task": "H1a-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/H1a-test.md"
    },
    {
      "id": "H1a-integ",
      "name": "Health manager parity \u2013 aggregation logic (integration)",
      "type": "integration",
      "phase": "H1a \u2013 Detection & Aggregation",
      "status": "completed",
      "description": "Merge H1a code/test branches, rerun fmt/lint/tests, and prep for the CLI/doc UX phase.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/shell"
      ],
      "acceptance_criteria": [
        "wt/ps-h1a-health-integ merges ps-h1a-health-code/test into feat/p0-platform-stability.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; `cargo test -p substrate-shell health` executed/logged.",
        "Docs/tasks/session log updated; kickoff prompts for H1b-code/H1b-test linked."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Confirm H1a-code/test completed",
        "Set H1a-integ to in_progress, log START entry, commit docs update",
        "Create branch ps-h1a-health-integ",
        "Create worktree wt/ps-h1a-health-integ from that branch"
      ],
      "end_checklist": [
        "Merge branches, resolve conflicts",
        "Run required fmt/lint/tests",
        "Merge into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Publish H1b prompts"
      ],
      "depends_on": [
        "H1a-code",
        "H1a-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-h1a-health-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/H1a-integ.md"
    },
    {
      "id": "H1b-code",
      "name": "Health manager parity \u2013 UX & docs (code)",
      "type": "code",
      "phase": "H1b \u2013 CLI/Doctor UX & Docs",
      "status": "completed",
      "description": "Polish CLI/JSON output, doctor summaries, and documentation so the refined manager logic is visible and actionable across platforms.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "docs/USAGE.md",
        "docs/CONFIGURATION.md",
        "crates/shell/src/builtins/health.rs"
      ],
      "acceptance_criteria": [
        "`substrate health` text + JSON clearly distinguish host-only, world-only, and absent managers with severity guidance.",
        "Doctor/health docs include updated examples for Linux/macOS/WSL plus manager coverage tables.",
        "Telemetry/tracing snippets sanitized for manager names while conveying mismatches.",
        "`cargo fmt`; `cargo clippy -p substrate-shell -- -D warnings`; manual `substrate health --json` run recorded."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set H1b-code to in_progress, log START entry, commit docs update",
        "Create branch ps-h1b-healthux-code",
        "Create worktree wt/ps-h1b-healthux-code from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests/manual commands done",
        "Commit worktree changes",
        "Merge ps-h1b-healthux-code into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm H1b-integ prompt",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "H1a-integ"
      ],
      "concurrent_with": [
        "H1b-test"
      ],
      "worktree": "wt/ps-h1b-healthux-code",
      "integration_task": "H1b-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/H1b-code.md"
    },
    {
      "id": "H1b-test",
      "name": "Health manager parity \u2013 UX & docs (test)",
      "type": "test",
      "phase": "H1b \u2013 CLI/Doctor UX & Docs",
      "status": "completed",
      "description": "Add CLI/integration tests ensuring doctor + health commands emit the refined messages in both text and JSON modes across mocked manager scenarios.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/shell/tests",
        "docs/USAGE.md"
      ],
      "acceptance_criteria": [
        "Tests assert text + JSON outputs for host-only, world-only, both-missing cases with severity alignment.",
        "PowerShell/macOS fixtures updated where necessary.",
        "`cargo fmt`; `cargo test -p substrate-shell health`; `substrate health --json` harness invocation logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Set H1b-test to in_progress, log START entry, commit docs update",
        "Create branch ps-h1b-healthux-test",
        "Create worktree wt/ps-h1b-healthux-test from that branch"
      ],
      "end_checklist": [
        "Ensure fmt/tests/manual commands recorded",
        "Commit worktree changes",
        "Merge ps-h1b-healthux-test into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Confirm H1b-integ prompt",
        "Commit docs update on feat/p0-platform-stability"
      ],
      "depends_on": [
        "H1a-integ"
      ],
      "concurrent_with": [
        "H1b-code"
      ],
      "worktree": "wt/ps-h1b-healthux-test",
      "integration_task": "H1b-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/H1b-test.md"
    },
    {
      "id": "H1b-integ",
      "name": "Health manager parity \u2013 UX & docs (integration)",
      "type": "integration",
      "phase": "H1b \u2013 CLI/Doctor UX & Docs",
      "status": "completed",
      "description": "Merge H1b code/test branches, re-run fmt/lint/tests, and close the P0 program with updated docs/logs/tasks.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/shell",
        "docs/USAGE.md",
        "docs/CONFIGURATION.md"
      ],
      "acceptance_criteria": [
        "wt/ps-h1b-healthux-integ merges ps-h1b-healthux-code/test and syncs with feat/p0-platform-stability.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; `cargo test -p substrate-shell health`; manual `substrate health --json` recorded.",
        "Docs/tasks/session log updated noting closure of the P0 backlog items or follow-ups."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability, pull latest",
        "Confirm H1b-code/test completed",
        "Set H1b-integ to in_progress, log START entry, commit docs update",
        "Create branch ps-h1b-healthux-integ",
        "Create worktree wt/ps-h1b-healthux-integ from that branch"
      ],
      "end_checklist": [
        "Merge code/test branches, resolve conflicts",
        "Run required fmt/lint/tests",
        "Merge into feat/p0-platform-stability",
        "Update tasks.json + session_log.md with END entry",
        "Document closure/hand-off"
      ],
      "depends_on": [
        "H1b-code",
        "H1b-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-h1b-healthux-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/H1b-integ.md"
    },
    {
      "id": "S1d-code",
      "name": "Installer socket-activation parity (code)",
      "type": "code",
      "phase": "S1d \u2013 Installer Socket-Activation Parity",
      "status": "completed",
      "description": "Update dev/prod installer scripts plus docs so socket-activated installs consistently provision the substrate group, apply lingering guidance, and reload the systemd units before prompting operators.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "scripts/substrate/dev-install-substrate.sh",
        "scripts/substrate/dev-uninstall-substrate.sh",
        "scripts/substrate/install-substrate.sh",
        "scripts/substrate/uninstall-substrate.sh",
        "docs/AGENTS.md",
        "docs/INSTALLATION.md",
        "docs/WORLD.md"
      ],
      "acceptance_criteria": [
        "Dev and production installers create the substrate group when missing, add the invoking user on Linux hosts (with sudo guidance for curl-based installs), and leave macOS/WSL behavior unchanged.",
        "Installers reload the socket/service units so `/run/substrate.sock` ends up owned by `root:substrate` with `0660` permissions, matching the provisioning scripts.",
        "Install output highlights lingering requirements (`loginctl enable-linger <user>`) including detection of the current linger state.",
        "Uninstall scripts remove the socket/service units and remind operators about lingering and group cleanup when appropriate.",
        "Docs (AGENTS.md, INSTALLATION.md, WORLD.md) describe the group/linger expectations for dev + production setups.",
        "`cargo fmt`; `shellcheck scripts/substrate/dev-install-substrate.sh scripts/substrate/dev-uninstall-substrate.sh scripts/substrate/install-substrate.sh scripts/substrate/uninstall-substrate.sh` executed or skips logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Read p0_platform_stability_plan.md, tasks.json, session_log.md, and the kickoff prompt",
        "Set S1d-code to in_progress, append START entry to the session log, commit doc update",
        "Create branch ps-s1d-devinstall-code, add worktree wt/ps-s1d-devinstall-code, and switch into it"
      ],
      "end_checklist": [
        "Ensure fmt/shellcheck completed (document skips if any)",
        "Commit worktree changes (script/doc updates) with descriptive message",
        "Merge ps-s1d-devinstall-code back into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry",
        "Confirm S1d-integ prompt remains accurate (edit if scope changed)",
        "Commit docs/task/log updates on feat/p0-platform-stability-follow-up"
      ],
      "depends_on": [
        "S1c-integ"
      ],
      "concurrent_with": [
        "S1d-test"
      ],
      "worktree": "wt/ps-s1d-devinstall-code",
      "integration_task": "S1d-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1d-code.md"
    },
    {
      "id": "S1d-test",
      "name": "Installer socket-activation parity (test)",
      "type": "test",
      "phase": "S1d \u2013 Installer Socket-Activation Parity",
      "status": "completed",
      "description": "Extend the installer smoke harness with dev/prod scenarios that verify socket activation parity, record lingering guidance, and gracefully skip when systemd prerequisites are missing.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "tests/installers/install_smoke.sh",
        "scripts/substrate/dev-install-substrate.sh",
        "scripts/substrate/install-substrate.sh",
        "docs/WORLD.md"
      ],
      "acceptance_criteria": [
        "Smoke script (or sibling harness) covers dev + prod installer flows, asserting `/run/substrate.sock` ownership (`root:substrate 0660`) after each run or capturing sudo output for curl installs.",
        "Harness verifies the invoking user belongs to the `substrate` group (or warns when running as root/curl context) and records lingering guidance plus whether `loginctl enable-linger` is already configured.",
        "Fixtures/log capture updated so non-systemd hosts record a structured skip with reasoning instead of failing.",
        "Session log documents platform constraints (e.g., containerized CI) that prevent executing privileged commands.",
        "`cargo fmt`; `./tests/installers/install_smoke.sh --scenario dev`; `./tests/installers/install_smoke.sh --scenario prod` executed or skips logged."
      ],
      "start_checklist": [
        "git checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Read p0_platform_stability_plan.md, tasks.json, session_log.md, S1d-code scope, and the S1d-test prompt",
        "Set S1d-test to in_progress, append START entry, commit doc update (`git commit -am \"docs: start S1d-test\"`)",
        "Create branch/worktree: `git checkout -b ps-s1d-devinstall-test`, `git worktree add wt/ps-s1d-devinstall-test ps-s1d-devinstall-test`, `cd wt/ps-s1d-devinstall-test`"
      ],
      "end_checklist": [
        "Ensure fmt/tests/scripts completed; log skips or blockers with detail",
        "Commit worktree changes (e.g., `test: add installer socket parity smoke`)",
        "Merge ps-s1d-devinstall-test into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md (END entry with command results, skip rationales, lingering guidance notes)",
        "Confirm S1d-integ prompt reflects the new smoke coverage expectations",
        "Commit doc/task/log updates (`git commit -am \"docs: finish S1d-test\"`), remove worktree, hand off on feat/p0-platform-stability-follow-up"
      ],
      "depends_on": [
        "S1d-code"
      ],
      "concurrent_with": [
        "S1d-code"
      ],
      "worktree": "wt/ps-s1d-devinstall-test",
      "integration_task": "S1d-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1d-test.md"
    },
    {
      "id": "S1d-integ",
      "name": "Installer socket-activation parity (integration)",
      "type": "integration",
      "phase": "S1d \u2013 Installer Socket-Activation Parity",
      "status": "completed",
      "description": "Merge the S1d installer code/test work, re-run fmt/shellcheck plus both installer smoke scenarios, and document the group creation + lingering guidance for dev/prod installers before fast-forwarding feat/p0-platform-stability-follow-up.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "scripts/substrate/dev-install-substrate.sh",
        "scripts/substrate/install-substrate.sh",
        "scripts/substrate/dev-uninstall-substrate.sh",
        "scripts/substrate/uninstall-substrate.sh",
        "tests/installers/install_smoke.sh",
        "docs/AGENTS.md",
        "docs/INSTALLATION.md",
        "docs/WORLD.md"
      ],
      "acceptance_criteria": [
        "ps-s1d-devinstall-integ merges ps-s1d-devinstall-code/test cleanly and fast-forwards back onto feat/p0-platform-stability-follow-up.",
        "`cargo fmt`; `shellcheck scripts/substrate/dev-install-substrate.sh scripts/substrate/dev-uninstall-substrate.sh scripts/substrate/install-substrate.sh scripts/substrate/uninstall-substrate.sh`; `./tests/installers/install_smoke.sh --scenario dev`; `./tests/installers/install_smoke.sh --scenario prod` executed or skips/logged output.",
        "Session log and docs capture installer parity guidance (substrate group creation + loginctl lingering for dev/prod paths) along with smoke command outcomes/skips.",
        "tasks.json reflects `S1d-code`, `S1d-test`, and `S1d-integ` completion, worktree removed, and stakeholders notified of parity readiness."
      ],
      "start_checklist": [
        "git checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Confirm S1d-code and S1d-test branches are ready/merged into feat/p0-platform-stability-follow-up",
        "Set S1d-integ to in_progress, append START entry, commit doc update (`git commit -am \"docs: start S1d-integ\"`)",
        "Create branch/worktree: `git checkout -b ps-s1d-devinstall-integ`, `git worktree add wt/ps-s1d-devinstall-integ ps-s1d-devinstall-integ`, `cd wt/ps-s1d-devinstall-integ`"
      ],
      "end_checklist": [
        "Confirm commands succeeded; log skips with justification",
        "Merge integration branch back into feat/p0-platform-stability-follow-up (fast-forward)",
        "Update tasks.json (S1d-* statuses), append END entry with smoke results + lingering/group notes + Windows hand-off",
        "Document installer guidance updates/next steps in session log and notify stakeholders that dev installer parity is met",
        "Commit doc/task/log updates (`git commit -am \"docs: finish S1d-integ\"`), remove worktree"
      ],
      "depends_on": [
        "S1d-code",
        "S1d-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-s1d-devinstall-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1d-integ.md"
    },
    {
      "id": "S1e-code",
      "name": "Installer state tracking & cleanup (code)",
      "type": "code",
      "phase": "S1e \u2013 Installer State Tracking",
      "status": "completed",
      "description": "Persist install-time host tweaks (substrate group membership, loginctl lingering, future interactive choices) and add opt-in uninstall cleanup so Substrate can restore the host to its prior state.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "scripts/substrate/install-substrate.sh",
        "scripts/substrate/dev-install-substrate.sh",
        "scripts/substrate/uninstall-substrate.sh",
        "scripts/substrate/dev-uninstall-substrate.sh",
        "docs/INSTALLATION.md",
        "docs/WORLD.md",
        "docs/CONFIGURATION.md"
      ],
      "acceptance_criteria": [
        "Installers detect/record whether the substrate group existed, which users were added, and each user\u2019s prior loginctl lingering state (metadata stored under ~/.substrate).",
        "Uninstallers offer a flag (and future interactive mode hook) that removes group membership and disables lingering only when Substrate previously enabled them; default behavior continues to print guidance when provenance is unknown.",
        "Metadata schema/versioning documented so future installers can add new host-state toggles without breaking older entries.",
        "Docs describe the new cleanup flag, metadata location, and how interactive install/uninstall flow will surface these options.",
        "`cargo fmt`; `shellcheck scripts/substrate/dev-install-substrate.sh scripts/substrate/install-substrate.sh scripts/substrate/dev-uninstall-substrate.sh scripts/substrate/uninstall-substrate.sh` executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Read the S1d results, plan/tasks/session log, and this kickoff prompt",
        "Set S1e-code to in_progress, append START entry, commit doc update (`git commit -am \"docs: start S1e-code\"`)",
        "Create branch/worktree: `git checkout -b ps-s1e-installer-code`, `git worktree add wt/ps-s1e-installer-code ps-s1e-installer-code`, `cd wt/ps-s1e-installer-code`"
      ],
      "end_checklist": [
        "Ensure fmt/shellcheck completed (note skips with justification)",
        "Commit worktree changes with descriptive message",
        "Merge ps-s1e-installer-code into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry",
        "Confirm S1e-integ prompt contents (or add it if missing)",
        "Commit doc/task/log updates (`git commit -am \"docs: finish S1e-code\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "S1d-code"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-s1e-installer-code",
      "integration_task": "S1e-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1e-code.md"
    },
    {
      "id": "S1e-test",
      "name": "Installer state tracking & cleanup (test)",
      "type": "test",
      "phase": "S1e \u2013 Installer State Tracking",
      "status": "completed",
      "description": "Add installer harness coverage to validate the metadata schema, cleanup flag behavior, and edge cases (missing/corrupt files, multi-user entries) introduced in S1e-code.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "scripts/substrate/install-substrate.sh",
        "scripts/substrate/dev-install-substrate.sh",
        "scripts/substrate/uninstall-substrate.sh",
        "scripts/substrate/dev-uninstall-substrate.sh",
        "tests/installers"
      ],
      "acceptance_criteria": [
        "Unit/integration tests cover metadata creation/upgrade paths, fallback behavior when the file is missing, and cleanup-flag behavior when Substrate previously toggled lingering/group membership.",
        "Harness scripts simulate multi-user metadata so we verify only recorded users/groups are modified.",
        "Test docs/logs describe how to exercise the cleanup flag on real hosts vs hermetic mocks.",
        "`cargo fmt`; installer harness/tests executed (or skips logged) with command output captured in the session log."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Review S1e-code implementation, plan/tasks/session log, and this prompt",
        "Set S1e-test to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-s1e-installer-test`, `git worktree add wt/ps-s1e-installer-test ps-s1e-installer-test`, `cd wt/ps-s1e-installer-test`"
      ],
      "end_checklist": [
        "Ensure fmt/tests/scripts completed; document skips with justification",
        "Commit worktree changes (tests/harness updates)",
        "Merge ps-s1e-installer-test into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include command results)",
        "Confirm S1e-integ prompt reflects new harness coverage",
        "Commit doc/task/log updates (`git commit -am \"docs: finish S1e-test\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "S1e-code"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-s1e-installer-test",
      "integration_task": "S1e-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1e-test.md"
    },
    {
      "id": "S1e-integ",
      "name": "Installer state tracking & cleanup (integration)",
      "type": "integration",
      "phase": "S1e \u2013 Installer State Tracking",
      "status": "completed",
      "description": "Merge the S1e code/test branches, re-run fmt/shellcheck/tests, and land the installer metadata feature on feat/p0-platform-stability-follow-up with updated docs/logs.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "scripts/substrate",
        "docs/INSTALLATION.md",
        "docs/WORLD.md"
      ],
      "acceptance_criteria": [
        "wt/ps-s1e-installer-integ merges ps-s1e-installer-code/test cleanly and fast-forwards feat/p0-platform-stability-follow-up.",
        "`cargo fmt`; `shellcheck` on installer/uninstaller scripts; installer harness/tests re-run (or skips logged) with results recorded.",
        "tasks.json + session_log.md updated with END entry; next prompts (interactive installer work) referenced."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Confirm S1e-code/test completed",
        "Set S1e-integ to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-s1e-installer-integ`, `git worktree add wt/ps-s1e-installer-integ ps-s1e-installer-integ`, `cd wt/ps-s1e-installer-integ`"
      ],
      "end_checklist": [
        "Merge code/test branches, resolve conflicts",
        "Run required fmt/shellcheck/tests; capture output",
        "Fast-forward merge into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Commit doc/task/log updates (`git commit -am \"docs: finish S1e-integ\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "S1e-code",
        "S1e-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-s1e-installer-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/S1e-integ.md"
    },
    {
      "id": "R2a-code",
      "name": "Replay agent-backed execution \u2013 agent path (code)",
      "type": "code",
      "phase": "R2 \u2013 Agent-backed Replay",
      "status": "completed",
      "description": "Add an agent-backed replay path with defaults/flags so replay prefers the world-agent when healthy.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "crates/shell",
        "crates/world-agent",
        "docs/TRACE.md",
        "docs/WORLD.md"
      ],
      "acceptance_criteria": [
        "Replay prefers the agent path when `/run/substrate.sock` is healthy; `--no-world`/`SUBSTRATE_REPLAY_USE_WORLD=disabled` forces host-only.",
        "An explicit opt-in flag/env enables the legacy local-backend fallback without changing the default agent-first behavior.",
        "Docs/help + telemetry/log output describe the chosen replay path and controls.",
        "`cargo fmt`; `cargo clippy -p substrate-replay -- -D warnings`; `cargo test -p substrate-replay -- --nocapture` executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Review R1 outputs, plan/tasks/session log, and this prompt",
        "Set R2a-code to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2a-replay-agent-code`, `git worktree add wt/ps-r2a-replay-agent-code ps-r2a-replay-agent-code`, `cd wt/ps-r2a-replay-agent-code`"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests/manual agent/host/no-world smoke completed; note skips",
        "Commit replay/shell/world-agent changes + docs",
        "Merge ps-r2a-replay-agent-code into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Confirm R2a-integ prompt accuracy",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2a-code\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "S1e-integ"
      ],
      "concurrent_with": [
        "R2a-test"
      ],
      "worktree": "wt/ps-r2a-replay-agent-code",
      "integration_task": "R2a-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2a-code.md"
    },
    {
      "id": "R2a-test",
      "name": "Replay agent-backed execution \u2013 agent path (test)",
      "type": "test",
      "phase": "R2 \u2013 Agent-backed Replay",
      "status": "completed",
      "description": "Add tests covering agent-backed replay toggles, caging propagation, and host-only mode.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "crates/shell/tests",
        "docs/TRACE.md"
      ],
      "acceptance_criteria": [
        "Tests assert replay chooses the agent path when the socket probe is healthy (mocked client).",
        "Fixtures cover `--no-world`/`SUBSTRATE_REPLAY_USE_WORLD=disabled` host-only behavior plus caged/uncaged cwd propagation.",
        "Warning output remains unchanged for host-only runs; telemetry records agent path usage.",
        "`cargo fmt`; `cargo test -p substrate-replay -- --nocapture`; `cargo test -p substrate-shell replay_world` executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Review R2a-code scope, plan/tasks/session log, and this prompt",
        "Set R2a-test to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2a-replay-agent-test`, `git worktree add wt/ps-r2a-replay-agent-test ps-r2a-replay-agent-test`, `cd wt/ps-r2a-replay-agent-test`"
      ],
      "end_checklist": [
        "Ensure fmt/tests completed; document skips with justification",
        "Commit worktree changes (tests/fixtures)",
        "Merge ps-r2a-replay-agent-test into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include command results)",
        "Confirm R2a-integ prompt contents",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2a-test\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "S1e-integ"
      ],
      "concurrent_with": [
        "R2a-code"
      ],
      "worktree": "wt/ps-r2a-replay-agent-test",
      "integration_task": "R2a-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2a-test.md"
    },
    {
      "id": "R2a-integ",
      "name": "Replay agent-backed execution \u2013 agent path (integration)",
      "type": "integration",
      "phase": "R2 \u2013 Agent-backed Replay",
      "status": "completed",
      "description": "Merge the R2a code/test branches, rerun fmt/lint/tests, and document agent-backed defaults before fallback work begins.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "crates/shell",
        "crates/world-agent"
      ],
      "acceptance_criteria": [
        "wt/ps-r2a-replay-agent-integ merges ps-r2a-replay-agent-code/test and fast-forwards feat/p0-platform-stability-follow-up.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; `cargo test -p substrate-replay -- --nocapture`; `cargo test -p substrate-shell replay_world` executed/logged.",
        "tasks.json + session_log.md updated with END entry; R2b prompts confirmed."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Confirm R2a-code/test completed",
        "Set R2a-integ to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2a-replay-agent-integ`, `git worktree add wt/ps-r2a-replay-agent-integ ps-r2a-replay-agent-integ`, `cd wt/ps-r2a-replay-agent-integ`"
      ],
      "end_checklist": [
        "Merge code/test branches, resolve conflicts",
        "Run required fmt/lint/tests; capture output",
        "Fast-forward merge into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2a-integ\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2a-code",
        "R2a-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-r2a-replay-agent-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2a-integ.md"
    },
    {
      "id": "R2b-code",
      "name": "Replay agent-backed execution \u2013 fallbacks & warnings (code)",
      "type": "code",
      "phase": "R2 \u2013 Agent-backed Replay",
      "status": "completed",
      "description": "Improve warning output and copy-diff fallback behavior (root retries, overrides, telemetry).",
      "references": [
        "docs/project_management/next/p0-platform_stability/p0_platform_stability_plan.md",
        "crates/replay",
        "crates/shell",
        "crates/world-agent",
        "docs/TRACE.md"
      ],
      "acceptance_criteria": [
        "Agent fallback warnings emit once per replay with actionable guidance.",
        "Copy-diff fallback retries `/run`, `/tmp`, `/var/tmp` (or override) and logs selected root.",
        "Docs/help highlight warning text, overrides, and cleanup guidance.",
        "`cargo fmt`; `cargo clippy -p substrate-replay -- -D warnings`; targeted replay warning/fallback tests executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Review R2a-integ outputs, plan/tasks/session log, and this prompt",
        "Set R2b-code to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2b-replay-fallback-code`, `git worktree add wt/ps-r2b-replay-fallback-code ps-r2b-replay-fallback-code`, `cd wt/ps-r2b-replay-fallback-code`"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests/manual warnings replay completed; note skips",
        "Commit warning/fallback changes + docs",
        "Merge ps-r2b-replay-fallback-code into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include command results)",
        "Confirm R2b-integ prompt contents",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2b-code\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2a-integ"
      ],
      "concurrent_with": [
        "R2b-test"
      ],
      "worktree": "wt/ps-r2b-replay-fallback-code",
      "integration_task": "R2b-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2b-code.md"
    },
    {
      "id": "R2b-test",
      "name": "Replay agent-backed execution \u2013 fallbacks & warnings (test)",
      "type": "test",
      "phase": "R2 \u2013 Agent-backed Replay",
      "status": "completed",
      "description": "Add tests covering warning de-duplication, copy-diff overrides, and ENOSPC retries.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "crates/shell/tests"
      ],
      "acceptance_criteria": [
        "Tests assert only a single warning is emitted when falling back from agent to local backend.",
        "Copy-diff override env/flag ensures custom root selection is logged and honored.",
        "ENOSPC retry behavior verified using constrained scratch fixtures.",
        "`cargo fmt`; `cargo test -p substrate-replay -- --nocapture`; `cargo test -p substrate-shell replay_world` executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Review R2b-code scope, plan/tasks/session log, and this prompt",
        "Set R2b-test to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2b-replay-fallback-test`, `git worktree add wt/ps-r2b-replay-fallback-test ps-r2b-replay-fallback-test`, `cd wt/ps-r2b-replay-fallback-test`"
      ],
      "end_checklist": [
        "Ensure fmt/tests completed; document skips with justification",
        "Commit worktree changes (tests/fixtures)",
        "Merge ps-r2b-replay-fallback-test into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include command results)",
        "Confirm R2b-integ prompt contents",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2b-test\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2a-integ"
      ],
      "concurrent_with": [
        "R2b-code"
      ],
      "worktree": "wt/ps-r2b-replay-fallback-test",
      "integration_task": "R2b-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2b-test.md"
    },
    {
      "id": "R2b-integ",
      "name": "Replay agent-backed execution \u2013 fallbacks & warnings (integration)",
      "type": "integration",
      "phase": "R2 \u2013 Agent-backed Replay",
      "status": "completed",
      "description": "Merge the R2b code/test branches, rerun fmt/lint/tests, and document fallback behavior before coverage work begins.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "crates/shell"
      ],
      "acceptance_criteria": [
        "wt/ps-r2b-replay-fallback-integ merges ps-r2b-replay-fallback-code/test and fast-forwards feat/p0-platform-stability-follow-up.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; `cargo test -p substrate-replay -- --nocapture`; `cargo test -p substrate-shell replay_world` executed/logged.",
        "tasks.json + session_log.md updated with END entry; R2c prompts confirmed."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Confirm R2b-code/test completed",
        "Set R2b-integ to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2b-replay-fallback-integ`, `git worktree add wt/ps-r2b-replay-fallback-integ ps-r2b-replay-fallback-integ`, `cd wt/ps-r2b-replay-fallback-integ`"
      ],
      "end_checklist": [
        "Merge code/test branches, resolve conflicts",
        "Run required fmt/lint/tests; capture output",
        "Fast-forward merge into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2b-integ\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2b-code",
        "R2b-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-r2b-replay-fallback-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2b-integ.md"
    },
    {
      "id": "R2c-code",
      "name": "Replay agent-backed execution \u2013 coverage polish (code)",
      "type": "code",
      "phase": "R2 \u2013 Agent-backed Replay",
      "status": "completed",
      "description": "Polish CLI/docs/telemetry for replay toggles, capture manual agent vs no-world samples, and ensure warnings align with docs.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "docs/TRACE.md",
        "docs/WORLD.md",
        "crates/replay",
        "crates/shell"
      ],
      "acceptance_criteria": [
        "Replay CLI help/docs explain agent vs host-only vs local fallback (warning samples included).",
        "Telemetry/docs show new replay fields; manual `substrate --replay --replay-verbose` samples captured for agent vs no-world.",
        "Warnings introduced in R2b are referenced consistently in docs and CLI output.",
        "`cargo fmt`; `cargo clippy -p substrate-shell -- -D warnings`; `cargo test -p substrate-shell replay_world` executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Review R2b-integ outputs, plan/tasks/session log, and this prompt",
        "Set R2c-code to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2c-replay-coverage-code`, `git worktree add wt/ps-r2c-replay-coverage-code ps-r2c-replay-coverage-code`, `cd wt/ps-r2c-replay-coverage-code`"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests/manual replay demos completed; note skips",
        "Commit CLI/doc/telemetry updates",
        "Merge ps-r2c-replay-coverage-code into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Confirm R2c-integ prompt contents",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2c-code\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2b-integ"
      ],
      "concurrent_with": [
        "R2c-test"
      ],
      "worktree": "wt/ps-r2c-replay-coverage-code",
      "integration_task": "R2c-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2c-code.md"
    },
    {
      "id": "R2c-test",
      "name": "Replay agent-backed execution (tests)",
      "type": "test",
      "phase": "R2 \u2013 Agent-backed Replay",
      "status": "completed",
      "description": "Full coverage for agent path vs local fallback vs host-only, including ENOSPC retry and caged alignment.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "crates/shell/tests",
        "crates/world/tests",
        "docs/TRACE.md"
      ],
      "acceptance_criteria": [
        "Tests assert agent path chosen when socket probe healthy; telemetry/warnings verified.",
        "Tests assert fallback to local backend/copy-diff when agent unavailable, including ENOSPC retry/override.",
        "Fixtures ensure cwd/anchor/caging/env alignment between spans and replayed commands (caged + uncaged).",
        "`cargo fmt`; `cargo test -p substrate-replay -- --nocapture`; `cargo test -p substrate-shell replay_world` executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Review R2c-code scope, plan/tasks/session log, and this prompt",
        "Set R2c-test to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2c-replay-agent-test`, `git worktree add wt/ps-r2c-replay-agent-test ps-r2c-replay-agent-test`, `cd wt/ps-r2c-replay-agent-test`"
      ],
      "end_checklist": [
        "Ensure fmt/tests completed; document skips with justification",
        "Commit worktree changes (tests/fixtures)",
        "Merge ps-r2c-replay-agent-test into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include command results)",
        "Confirm R2c-integ prompt contents",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2c-test\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2b-integ"
      ],
      "concurrent_with": [
        "R2c-code"
      ],
      "worktree": "wt/ps-r2c-replay-agent-test",
      "integration_task": "R2c-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2c-test.md"
    },
    {
      "id": "R2c-integ",
      "name": "Replay agent-backed execution (integration)",
      "type": "integration",
      "phase": "R2 \u2013 Agent-backed Replay",
      "status": "completed",
      "description": "Merge the R2c code/test branches, rerun fmt/lint/tests, and finalize agent-backed replay rollout.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "crates/shell",
        "crates/world-agent",
        "docs/TRACE.md"
      ],
      "acceptance_criteria": [
        "wt/ps-r2c-replay-agent-integ merges ps-r2c-replay-coverage-code/test and fast-forwards feat/p0-platform-stability-follow-up.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; `cargo test -p substrate-replay -- --nocapture`; `cargo test -p substrate-shell replay_world` executed/logged.",
        "tasks.json + session_log.md updated with END entry; handoff noted."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Confirm R2c-code/test completed",
        "Set R2c-integ to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2c-replay-agent-integ`, `git worktree add wt/ps-r2c-replay-agent-integ ps-r2c-replay-agent-integ`, `cd wt/ps-r2c-replay-agent-integ`"
      ],
      "end_checklist": [
        "Merge code/test branches, resolve conflicts",
        "Run required fmt/lint/tests; capture output",
        "Fast-forward merge into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2c-integ\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2c-code",
        "R2c-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-r2c-replay-agent-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2c-integ.md"
    },
    {
      "id": "R2c-buffer",
      "name": "Buffer: stabilize after R2c",
      "type": "ops",
      "phase": "R2 \u2013 Agent-backed Replay",
      "status": "completed",
      "description": "Short buffer to resolve conflicts/skips after R2c-integ before starting R2d.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "docs/project_management/next/p0-platform-stability/session_log.md"
      ],
      "acceptance_criteria": [
        "R2c-integ merged into feat/p0-platform-stability-follow-up; no pending fmt/lint/test failures or unresolved skips.",
        "tasks.json + session_log.md updated to reflect buffer completion and readiness for R2d."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Confirm R2c-integ completed",
        "Set R2c-buffer to in_progress, append START entry, commit doc update"
      ],
      "end_checklist": [
        "Resolve any outstanding conflicts/skips from R2c-integ",
        "Update tasks.json + session_log.md with END entry",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2c-buffer\"`)"
      ],
      "depends_on": [
        "R2c-integ"
      ],
      "concurrent_with": [],
      "worktree": null,
      "integration_task": null,
      "kickoff_prompt": null
    },
    {
      "id": "R2d-code",
      "name": "Replay origin-aware defaults & agent routing (code)",
      "type": "code",
      "phase": "R2 \u2013 Agent-backed Replay",
      "status": "completed",
      "description": "Record execution origin/transport in spans, default replays to the recorded origin, add a flip flag, and make world-mode replays prefer the agent socket with a clean fallback to the local backend.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "crates/shell",
        "crates/world-agent",
        "crates/trace",
        "docs/REPLAY.md",
        "docs/TRACE.md"
      ],
      "acceptance_criteria": [
        "Spans record execution_origin (host/world) and world transport at command_complete; replay reconstruction consumes it (greenfield schema, no compat needed).",
        "Default replay honors recorded origin; --flip-world (alias --flip) inverts it; --world/--no-world still override.",
        "World-mode replay uses the agent socket first and falls back once with a single warning to the local backend (overlay/fuse/copy-diff) while preserving cwd/anchor/caging/env from the span.",
        "Verbose output and telemetry document origin, flip reason, selected strategy, endpoint, and copy-diff root (including override env).",
        "`cargo fmt`; `cargo clippy -p substrate-replay -- -D warnings`; `cargo test -p substrate-replay -- --nocapture`; `cargo test -p substrate-shell replay_world` executed/logged; manual agent+host/no-world smoke noted."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Review R2a/R2b/R2c outputs, plan/tasks/session log, and this prompt",
        "Set R2d-code to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2d-replay-origin-code`, `git worktree add wt/ps-r2d-replay-origin-code ps-r2d-replay-origin-code`, `cd wt/ps-r2d-replay-origin-code`"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests/manual replay (agent vs host vs flipped) completed; note skips",
        "Commit schema/replay/shell/world-agent changes + docs",
        "Merge ps-r2d-replay-origin-code into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Confirm R2d-integ prompt accuracy",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2d-code\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2c-integ"
      ],
      "concurrent_with": [
        "R2d-test"
      ],
      "worktree": "wt/ps-r2d-replay-origin-code",
      "integration_task": "R2d-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2d-code.md"
    },
    {
      "id": "R2d-test",
      "name": "Replay origin-aware defaults & agent routing (test)",
      "type": "test",
      "phase": "R2 \u2013 Agent-backed Replay",
      "status": "completed",
      "description": "Add tests for recorded-origin defaults, flip flag, agent-first world path with fallback, and copy-diff override/warning behavior.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "crates/shell/tests",
        "crates/world/tests",
        "docs/REPLAY.md"
      ],
      "acceptance_criteria": [
        "Fixtures cover recorded-world spans defaulting to agent path, recorded-host spans defaulting to host, and --flip-world inversion for both.",
        "Agent socket success/failure is exercised via stubs; on failure replay falls back once to local backend with a single warning and preserved cwd/anchor/caging/env.",
        "Copy-diff fallback retries/override (`SUBSTRATE_COPYDIFF_ROOT`) are asserted with deduped warning text; verbose output captures chosen strategy and endpoint/root.",
        "`cargo fmt`; `cargo test -p substrate-replay -- --nocapture`; `cargo test -p substrate-shell replay_world` executed/logged; platform skips documented."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Review R2d-code scope, plan/tasks/session log, and this prompt",
        "Set R2d-test to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2d-replay-origin-test`, `git worktree add wt/ps-r2d-replay-origin-test ps-r2d-replay-origin-test`, `cd wt/ps-r2d-replay-origin-test`"
      ],
      "end_checklist": [
        "Ensure fmt/tests completed; document skips with justification",
        "Commit worktree changes (tests/fixtures)",
        "Merge ps-r2d-replay-origin-test into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include command results)",
        "Confirm R2d-integ prompt contents",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2d-test\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2c-integ"
      ],
      "concurrent_with": [
        "R2d-code"
      ],
      "worktree": "wt/ps-r2d-replay-origin-test",
      "integration_task": "R2d-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2d-test.md"
    },
    {
      "id": "R2d-integ",
      "name": "Replay origin-aware defaults & agent routing (integration)",
      "type": "integration",
      "phase": "R2 \u2013 Agent-backed Replay",
      "status": "completed",
      "description": "Merge the R2d code/test branches, rerun fmt/lint/tests, and finalize the origin-aware agent-first replay rollout.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/replay",
        "crates/shell",
        "crates/world-agent",
        "crates/trace",
        "docs/TRACE.md"
      ],
      "acceptance_criteria": [
        "wt/ps-r2d-replay-origin-integ merges ps-r2d-replay-origin-code/test and fast-forwards feat/p0-platform-stability-follow-up.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; `cargo test -p substrate-replay -- --nocapture`; `cargo test -p substrate-shell replay_world` executed/logged; manual agent vs host/flip smoke captured or skipped with reason.",
        "tasks.json + session_log.md updated with END entry; handoff noted."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Confirm R2d-code/test completed",
        "Set R2d-integ to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2d-replay-origin-integ`, `git worktree add wt/ps-r2d-replay-origin-integ ps-r2d-replay-origin-integ`, `cd wt/ps-r2d-replay-origin-integ`"
      ],
      "end_checklist": [
        "Merge code/test branches, resolve conflicts",
        "Run required fmt/lint/tests; capture output",
        "Fast-forward merge into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2d-integ\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2d-code",
        "R2d-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-r2d-replay-origin-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2d-integ.md"
    },
    {
      "id": "R2e-code",
      "name": "Policy-driven world fs mode (code)",
      "type": "code",
      "phase": "R2e \u2013 Policy-driven World FS Mode",
      "status": "completed",
      "description": "Add a broker policy toggle for read-only vs writable worlds, thread it through shell/world-agent, and document the knob so per-project/global policy controls world mutability.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "docs/CONFIGURATION.md",
        "crates/broker",
        "crates/shell",
        "crates/world-agent",
        "crates/world"
      ],
      "acceptance_criteria": [
        "Policy schema exposes world fs mode (read_only/writable) with default writable; invalid values produce clear errors.",
        "Shell passes the resolved policy into PTY + non-PTY world requests and surfaces the active mode via traces/doctor.",
        "World-agent/backends honor the mode (read-only disables copy-diff/upper writes; writable matches current behavior).",
        "Docs describe the knob and systemd expectations; doctor output highlights the active mode with remediation guidance.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; targeted suites (`cargo test -p substrate-shell world_enable`, `cargo test -p world-agent` or justified skips) executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Read plan, tasks.json, session_log.md, and this prompt",
        "Set R2e-code to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2e-world-fs-code`, `git worktree add wt/ps-r2e-world-fs-code ps-r2e-world-fs-code`, `cd wt/ps-r2e-world-fs-code`"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests completed (note skips)",
        "Commit code/doc changes",
        "Merge ps-r2e-world-fs-code into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Confirm R2e-integ prompt contents",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2e-code\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2d-integ"
      ],
      "concurrent_with": [
        "R2e-test"
      ],
      "worktree": "wt/ps-r2e-world-fs-code",
      "integration_task": "R2e-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2e-code.md"
    },
    {
      "id": "R2e-test",
      "name": "Policy-driven world fs mode (test)",
      "type": "test",
      "phase": "R2e \u2013 Policy-driven World FS Mode",
      "status": "completed",
      "description": "Add fixtures asserting policy-controlled read-only vs writable worlds (PTY + non-PTY) with trace/doctor coverage.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "docs/CONFIGURATION.md",
        "crates/shell/tests",
        "crates/world/tests"
      ],
      "acceptance_criteria": [
        "Read-only policy tests ensure writes fail cleanly and telemetry/doctor show read_only mode.",
        "Writable policy tests ensure overlay/copy-diff writes succeed and telemetry/doctor show writable mode.",
        "Coverage includes PTY path where feasible and documents skips when overlay/cgroup unavailable.",
        "`cargo fmt`; targeted suites (`cargo test -p substrate-shell world_enable`, `cargo test -p world-agent` or justified skips) executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Review plan, tasks.json, session_log.md, and R2e-code scope",
        "Set R2e-test to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2e-world-fs-test`, `git worktree add wt/ps-r2e-world-fs-test ps-r2e-world-fs-test`, `cd wt/ps-r2e-world-fs-test`"
      ],
      "end_checklist": [
        "Ensure fmt/tests completed; document skips with justification",
        "Commit test/fixture updates",
        "Merge ps-r2e-world-fs-test into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Confirm R2e-integ prompt contents",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2e-test\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2d-integ"
      ],
      "concurrent_with": [
        "R2e-code"
      ],
      "worktree": "wt/ps-r2e-world-fs-test",
      "integration_task": "R2e-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2e-test.md"
    },
    {
      "id": "R2e-integ",
      "name": "Policy-driven world fs mode (integration)",
      "type": "integration",
      "phase": "R2e \u2013 Policy-driven World FS Mode",
      "status": "queued",
      "description": "Merge the policy-driven world fs mode code/test branches, rerun fmt/lint/tests, and document read-only vs writable policy behavior.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "docs/CONFIGURATION.md",
        "crates/broker",
        "crates/shell",
        "crates/world-agent"
      ],
      "acceptance_criteria": [
        "wt/ps-r2e-world-fs-integ merges ps-r2e-world-fs-code/test and fast-forwards feat/p0-platform-stability-follow-up.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; targeted suites (`cargo test -p substrate-shell world_enable`, `cargo test -p world-agent` or justified skips) executed/logged.",
        "tasks.json + session_log.md capture END entry; docs mention the new policy knob/systemd expectations."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Confirm R2e-code/test completed",
        "Set R2e-integ to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2e-world-fs-integ`, `git worktree add wt/ps-r2e-world-fs-integ ps-r2e-world-fs-integ`, `cd wt/ps-r2e-world-fs-integ`"
      ],
      "end_checklist": [
        "Merge code/test branches, resolve conflicts",
        "Run required fmt/lint/tests; capture output",
        "Fast-forward merge into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2e-integ\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2e-code",
        "R2e-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-r2e-world-fs-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2e-integ.md"
    },
    {
      "id": "R2e-code",
      "name": "Policy-driven world fs mode (code)",
      "type": "code",
      "phase": "R2e \u2013 Policy-driven World FS Mode",
      "status": "completed",
      "description": "Add a broker policy toggle for read-only vs writable worlds, thread it through shell requests, and teach world-agent/backends to honor it so per-project/global policy controls world mutability.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "docs/CONFIGURATION.md",
        "crates/broker",
        "crates/shell",
        "crates/world-agent",
        "crates/world"
      ],
      "acceptance_criteria": [
        "Policy schema exposes world fs mode (read_only/writable) with default writable; validation errors surface clearly.",
        "Shell uses the resolved policy for PTY + non-PTY world requests and records the active mode in traces/doctor output.",
        "World-agent/backends honor the mode (read-only disables copy-diff/upper writes; writable keeps current behavior).",
        "Docs describe the new knob (CONFIGURATION/WORLD) and doctor output highlights the active mode with remediation tips.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; targeted suites (`cargo test -p substrate-shell world_enable`, `cargo test -p world-agent` or justified skips) executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Read plan, tasks.json, session_log.md, and this prompt",
        "Set R2e-code to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2e-world-fs-code`, `git worktree add wt/ps-r2e-world-fs-code ps-r2e-world-fs-code`, `cd wt/ps-r2e-world-fs-code`"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests completed (note skips)",
        "Commit code/doc changes",
        "Merge ps-r2e-world-fs-code into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Confirm R2e-integ prompt contents",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2e-code\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2d-integ"
      ],
      "concurrent_with": [
        "R2e-test"
      ],
      "worktree": "wt/ps-r2e-world-fs-code",
      "integration_task": "R2e-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2e-code.md"
    },
    {
      "id": "R2e-test",
      "name": "Policy-driven world fs mode (test)",
      "type": "test",
      "phase": "R2e \u2013 Policy-driven World FS Mode",
      "status": "queued",
      "description": "Add tests/fixtures that assert policy-controlled read-only vs writable world behavior (PTY + non-PTY) with trace/doctor coverage.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "docs/CONFIGURATION.md",
        "crates/shell/tests",
        "crates/world/tests"
      ],
      "acceptance_criteria": [
        "Fixtures cover read-only policy (writes fail cleanly, telemetry/doctor show ro) and writable policy (writes succeed via overlay/copy-diff).",
        "Coverage includes PTY/REPL path where feasible and documents skips on hosts lacking overlay/cgroup permissions.",
        "`cargo fmt`; targeted suites (`cargo test -p substrate-shell world_enable`, `cargo test -p world-agent` or justified skips) executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Review plan, tasks.json, session_log.md, and R2e-code scope",
        "Set R2e-test to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2e-world-fs-test`, `git worktree add wt/ps-r2e-world-fs-test ps-r2e-world-fs-test`, `cd wt/ps-r2e-world-fs-test`"
      ],
      "end_checklist": [
        "Ensure fmt/tests completed; document skips with justification",
        "Commit test/fixture updates",
        "Merge ps-r2e-world-fs-test into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Confirm R2e-integ prompt contents",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2e-test\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2d-integ"
      ],
      "concurrent_with": [
        "R2e-code"
      ],
      "worktree": "wt/ps-r2e-world-fs-test",
      "integration_task": "R2e-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2e-test.md"
    },
    {
      "id": "R2e-integ",
      "name": "Policy-driven world fs mode (integration)",
      "type": "integration",
      "phase": "R2e \u2013 Policy-driven World FS Mode",
      "status": "queued",
      "description": "Merge the policy-driven world fs mode code/test branches, run fmt/lint/tests, and document RO vs writable policy behavior before moving on.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "docs/CONFIGURATION.md",
        "crates/broker",
        "crates/shell",
        "crates/world-agent"
      ],
      "acceptance_criteria": [
        "wt/ps-r2e-world-fs-integ merges ps-r2e-world-fs-code/test cleanly and fast-forwards feat/p0-platform-stability-follow-up.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; targeted suites (`cargo test -p substrate-shell world_enable`, `cargo test -p world-agent` or justified skips) executed/logged.",
        "tasks.json + session_log.md updated with END entry; docs note the policy knob/systemd expectations."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Confirm R2e-code/test completed",
        "Set R2e-integ to in_progress, append START entry, commit doc update",
        "Create branch/worktree: `git checkout -b ps-r2e-world-fs-integ`, `git worktree add wt/ps-r2e-world-fs-integ ps-r2e-world-fs-integ`, `cd wt/ps-r2e-world-fs-integ`"
      ],
      "end_checklist": [
        "Merge code/test branches, resolve conflicts",
        "Run required fmt/lint/tests; capture output",
        "Fast-forward merge into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2e-integ\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2e-code",
        "R2e-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-r2e-world-fs-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2e-integ.md"
    },
    {
      "id": "R2f-code",
      "name": "Host replay span parity (code)",
      "type": "code",
      "phase": "R2f \u2013 Host Replay Parity",
      "status": "completed",
      "description": "Emit replayable spans for host-only executions so host commands can be replayed with the same fidelity as world spans without probing the world backend.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/shell",
        "crates/shim",
        "crates/replay",
        "crates/trace"
      ],
      "acceptance_criteria": [
        "Host-only executions (--no-world, SUBSTRATE_REPLAY_USE_WORLD=disabled, or policy-host paths) still emit span_ids and replay_context with execution_origin=host.",
        "Shell/shim avoid agent/world socket probes in host-only mode while preserving policy decisions and telemetry fields; trace schema remains backward compatible.",
        "Replay consumes host spans and defaults to host execution; overrides (--world/--no-world, flip) continue to work with clear warnings when forced.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; targeted suites (`cargo test -p substrate-shell replay_world`, `cargo test -p substrate-replay -- --nocapture`) executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Read p0_platform_stability_plan.md, tasks.json, session_log.md, and this prompt",
        "Set R2f-code to in_progress; append START entry; commit doc update (`git commit -am \"docs: start R2f-code\"`)",
        "Create branch/worktree: `git checkout -b ps-r2f-host-replay-code`, `git worktree add wt/ps-r2f-host-replay-code ps-r2f-host-replay-code`, `cd wt/ps-r2f-host-replay-code`"
      ],
      "end_checklist": [
        "Ensure fmt/clippy/tests completed (note skips)",
        "Commit code/doc changes",
        "Merge ps-r2f-host-replay-code into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Confirm R2f-integ prompt contents",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2f-code\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2e-integ"
      ],
      "concurrent_with": [
        "R2f-test"
      ],
      "worktree": "wt/ps-r2f-host-replay-code",
      "integration_task": "R2f-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2f-code.md"
    },
    {
      "id": "R2f-test",
      "name": "Host replay span parity (test)",
      "type": "test",
      "phase": "R2f \u2013 Host Replay Parity",
      "status": "completed",
      "description": "Add coverage ensuring host-only commands emit replayable spans and that replay defaults to host execution without touching the world backend.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/shell/tests",
        "crates/replay",
        "crates/trace"
      ],
      "acceptance_criteria": [
        "Tests assert span_ids + replay_context exist for host-only commands (--no-world, env opt-out) and mark execution_origin=host.",
        "Replay fixtures run host spans on the host with no agent/world socket probes; warnings are single-shot when overrides force world use.",
        "Coverage includes async REPL commands and non-PTY replay entrypoints; skips justified when host prerequisites differ.",
        "`cargo fmt`; targeted suites (`cargo test -p substrate-shell replay_world`, `cargo test -p substrate-replay -- --nocapture`) executed/logged."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Review plan/tasks/session_log.md and R2f-code scope",
        "Set R2f-test to in_progress; append START entry; commit doc update (`git commit -am \"docs: start R2f-test\"`)",
        "Create branch/worktree: `git checkout -b ps-r2f-host-replay-test`, `git worktree add wt/ps-r2f-host-replay-test ps-r2f-host-replay-test`, `cd wt/ps-r2f-host-replay-test`"
      ],
      "end_checklist": [
        "Ensure fmt/tests completed; document skips with justification",
        "Commit test/fixture updates",
        "Merge ps-r2f-host-replay-test into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Confirm R2f-integ prompt contents",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2f-test\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2e-integ"
      ],
      "concurrent_with": [
        "R2f-code"
      ],
      "worktree": "wt/ps-r2f-host-replay-test",
      "integration_task": "R2f-integ",
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2f-test.md"
    },
    {
      "id": "R2f-integ",
      "name": "Host replay span parity (integration)",
      "type": "integration",
      "phase": "R2f \u2013 Host Replay Parity",
      "status": "queued",
      "description": "Merge the host span replay parity code/test branches, rerun fmt/lint/tests, and ensure host-only spans are replayable without world dependencies.",
      "references": [
        "docs/project_management/next/p0-platform-stability/p0_platform_stability_plan.md",
        "crates/shell",
        "crates/shim",
        "crates/replay",
        "crates/trace"
      ],
      "acceptance_criteria": [
        "wt/ps-r2f-host-replay-integ merges ps-r2f-host-replay-code/test cleanly and fast-forwards feat/p0-platform-stability-follow-up.",
        "`cargo fmt`; `cargo clippy --workspace --all-targets -- -D warnings`; `cargo test -p substrate-replay -- --nocapture`; `cargo test -p substrate-shell replay_world` executed/logged (note skips if world socket absent).",
        "tasks.json + session_log.md updated with END entry; docs mention host span replay parity."
      ],
      "start_checklist": [
        "Checkout feat/p0-platform-stability-follow-up && git pull --ff-only",
        "Confirm R2f-code/test completed",
        "Set R2f-integ to in_progress; append START entry; commit doc update (`git commit -am \"docs: start R2f-integ\"`)",
        "Create branch/worktree: `git checkout -b ps-r2f-host-replay-integ`, `git worktree add wt/ps-r2f-host-replay-integ ps-r2f-host-replay-integ`, `cd wt/ps-r2f-host-replay-integ`"
      ],
      "end_checklist": [
        "Merge code/test branches, resolve conflicts",
        "Run required fmt/lint/tests; capture output",
        "Fast-forward merge into feat/p0-platform-stability-follow-up",
        "Update tasks.json + session_log.md with END entry (include commands run)",
        "Commit doc/task/log updates (`git commit -am \"docs: finish R2f-integ\"`), remove worktree, hand off"
      ],
      "depends_on": [
        "R2f-code",
        "R2f-test"
      ],
      "concurrent_with": [],
      "worktree": "wt/ps-r2f-host-replay-integ",
      "integration_task": null,
      "kickoff_prompt": "docs/project_management/next/p0-platform-stability/kickoff_prompts/R2f-integ.md"
    }
  ]
}
