# Kickoff: {{TASK_ID}} (integration platform-fix — {{PLATFORM}})

## Scope
- Ensure the slice behaves correctly on **{{PLATFORM}}**.
- This task is allowed to make production-code and/or test changes as needed to achieve cross-platform parity, but must not edit planning docs inside the worktree.
- Spec: `{{FEATURE_DIR}}/{{SPEC_FILE}}`
- Execution workflow standard: `docs/project_management/standards/TASK_TRIADS_WORKTREE_EXECUTION_STANDARD.md`
- This task must not merge back to the orchestration branch; the final aggregator integration task performs the merge once all platforms are green.

## Start Checklist
Do not edit planning docs inside the worktree.

1. Run this task on a machine that matches the required platform: **{{PLATFORM}}**.
2. Verify you are in the task worktree `{{WORKTREE}}` on branch `{{BRANCH}}` and that `.taskmeta.json` exists at the worktree root.
   - Do all work (edits, builds/tests, commits, and `make triad-task-finish`) from inside this worktree.
3. Read: plan.md, tasks.json, session_log.md, spec, this prompt.
4. If `.taskmeta.json` is missing or mismatched, stop and ask the operator to run:
   - `make triad-task-start FEATURE_DIR="{{FEATURE_DIR}}" TASK_ID="{{TASK_ID}}" TASK_PLATFORM={{PLATFORM}}`

## Requirements
- Before validating smoke or making fixes, merge the slice’s core integration branch into this worktree:
  - Find the core integration task for this slice in `tasks.json` (e.g., `C0-integ-core`) and merge its task branch into your current branch.
  - This ensures your platform-fix work starts from the merged code+test state that passed local integration gates.
- Validate platform smoke via CI for this platform (repeat until green if you make fixes):
  - `make feature-smoke FEATURE_DIR="{{FEATURE_DIR}}" PLATFORM={{PLATFORM}} RUNNER_KIND=self-hosted WORKFLOW_REF="{{ORCH_BRANCH}}" REMOTE=origin CLEANUP=1`
- If this is the Linux task and WSL coverage is required (see `tasks.json` meta: `wsl_required` + `wsl_task_mode`):
  - Bundled (default): dispatch with `RUN_WSL=1`:
    - `make feature-smoke FEATURE_DIR="{{FEATURE_DIR}}" PLATFORM=linux RUN_WSL=1 RUNNER_KIND=self-hosted WORKFLOW_REF="{{ORCH_BRANCH}}" REMOTE=origin CLEANUP=1`
- If smoke passes: record run id/URL in the END entry and do not change code.
- If smoke fails:
  1) Fix the issue in this worktree (platform-specific guards, path handling, deps) while keeping the spec contract intact.
  2) Run the appropriate local checks for your change (fmt/clippy and targeted tests).
  3) Re-run the CI smoke for this platform until green.

## End Checklist
1. Ensure smoke is green for {{PLATFORM}} and capture the run id/URL.
2. From inside the worktree, run: `make triad-task-finish TASK_ID="{{TASK_ID}}"`
3. Hand off run id/URL and any platform-specific notes to the operator (do not edit planning docs inside the worktree).
4. Do not delete the worktree (feature cleanup removes worktrees at feature end).
